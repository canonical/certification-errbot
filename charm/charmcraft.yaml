name: certification-errbot
type: charm
title: Hardware Certification errbot

summary: Canonical Hardware Certification errbot instance.

description: |
  errbot configured for mattermost,
  with Canonical Hardware Certification team relevant plugins.

base: ubuntu@24.04

platforms:
  amd64:

config:
  options:
    log-level:
      description: |
        Configures the application log level.

        Acceptable values are: "info", "debug", "warning", "error" and "critical"
      default: "info"
      type: string
    errbot-team:
      description: |
        The Mattermost team name.
      type: string
    errbot-server:
      description: |
        The Mattermost server address for Errbot.
      type: string
    errbot-token:
      description: |
        The token for Errbot authentication.
      type: string
    errbot-admins:
      description: |
        List of handles (prefixed with @, separated by space) who act as bot admins.
      type: string
    c3-client-id:
      description: |
        OAuth client ID for the C3 v2 API.
      type: string
    c3-client-secret:
      description: |
        OAuth client secret for the C3 v2 API.
      type: string
    github-token:
      description: |
        GitHub personal access token for API access.
      type: string
    github-org:
      description: |
        GitHub organization name to fetch PRs from.
      default: "canonical"
      type: string
    github-repositories:
      description: |
        Comma-separated list of repository names to monitor for PRs. If not set, uses default list.
      type: string
    github-team:
      description: |
        GitHub team name to send daily PR notifications for. Team members will receive PR summaries at 9am UTC Mon-Fri.
      type: string
    ldap-server:
      description: |
        LDAP server URL for user lookups.
      type: string
    ldap-base-dn:
      description: |
        LDAP base DN for user searches.
      type: string
    ldap-bind-dn:
      description: |
        LDAP bind DN for authentication.
      type: string
    ldap-bind-password:
      description: |
        LDAP bind password for authentication.
      type: string
    jira-server:
      description: |
        Jira server URL for issue tracking integration.
      type: string
    jira-token:
      description: |
        Jira API token for authentication.
      type: string

containers:
  errbot:
    resource: errbot-image

resources:
  errbot-image:
    type: oci-image
    description: OCI image for errbot with the plugin installed
    upstream-source: ghcr.io/canonical/certification-errbot:latest

parts:
  errbot:
    source: .
    plugin: charm
